# wolfTPM (TPM 2.0)

TPM 2.0 project written for embedded devices.


## TPM 2.0 Overview

### Hierarchies

Platform    TPM_RH_PLATFORM
Storage     TPM_RH_OWNER
Endorsement TPM_RH_ENDORSEMENT
Ephemeral   TPM_RH_NULL (no seed, lost on reboot)

Each hierarchy has their own manufacture generated seed.

The arguments used on TPM2_Create or TPM2_CreatePrimary create a template which is fed into a KDF to produce the same key based hierarchy used. This same key is generated the same each time and even after reboot. The generation of a new RSA 2048 bit key takes about 15 seconds, so typically these are created and then stored in NV using TPM2_EvictControl. Each TPM generates their own keys uniquely based on the seed.


### Platform Configuration Registers (PCRs)

Contains hash digests for SHA-1 and SHA-256 with an index 0-23.


## Building

1. Build wolfSSL:

```
./autogen.sh
./configure --enable-ecc --enable-sha512 && make
sudo make install
```

2. Build wolfTPM:

```
./configure && make
```


## Platform

This example was written for use on Raspberry PiÂ® 3 or the STM32 with the CubeMX HAL. This was tested using the Infineon OPTIGA (TM) Trusted Platform Module 2.0 SLB 9670.

The Raspberry 3 uses the native `spi_dev` interface and defaults to `/dev/spidev0.1`. If you are running the Infineon patches it overrides the kernel SPI interface with their `spi_tis_dev`, which currently causes this demo to fail.

This has only been tested and confirmed working with Rasbian 4.4.x.

To add additional SPI hardware support insert your own interface call in `tpm2_demo.c` for the `TPM2_IoCb` function.


## Sample Output

```
./examples/tpm/tpm_demo
TPM2: Caps 0x30000697, Did 0x001b, Vid 0x15d1, Rid 0x10 
TPM2_Startup pass
TPM2_SelfTest pass
TPM2_GetTestResult: Size 10, Rc 0x0
TPM2_IncrementalSelfTest: Rc 0x0, Alg 0x1 (Todo 0)
TPM2_GetCapability: Property FamilyIndicator 0x322e3000
TPM2_GetCapability: Property PCR Count 24
TPM2_GetRandom: Got 32 bytes
TPM2_StirRandom: success
TPM2_PCR_Read: Index 0, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 1, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 2, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 3, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 4, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 5, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 6, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 7, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 8, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 9, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 10, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 11, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 12, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 13, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 14, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 15, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 16, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 17, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 18, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 19, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 20, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 21, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 22, Digest Sz 32, Update Counter 22
TPM2_PCR_Read: Index 23, Digest Sz 32, Update Counter 22
TPM2_PCR_Extend success
TPM2_PCR_Read: Index 0, Digest Sz 32, Update Counter 23
TPM2_StartAuthSession: sessionHandle 0x3000000
TPM2_PolicyGetDigest: size 32
wc_Hash of PCR[0]: size 32
TPM2_PolicyPCR: Updated
TPM2_PolicyRestart: Done
TPM2_HashSequenceStart: sequenceHandle 0x80000000
Hash SHA256 test success
TPM2_CreatePrimary: Endorsement 0x80000000 (314 bytes)
TPM2_CreatePrimary: Platform 0x80000001 (282 bytes)
TPM2_LoadExternal: 0x80000002
TPM2_MakeCredential: credentialBlob 68, secret 256
TPM2_ReadPublic Handle 0x80000002: pub 314, name 34, qualifiedName 34
Create HMAC-SHA256 Key success, public 48, Private 141
TPM2_Load New HMAC Key Handle 0x80000002
TPM2_ObjectChangeAuth failed 2466: Unknown
TPM2_ObjectChangeAuth: private 0
TPM2_Create: New ECC Key: pub 88, priv 126
TPM2_Load New ECC Key Handle 0x80000002
TPM2_FlushContext: Closed sessionHandle 0x3000000
```


### With Debug Enabled:

```
./examples/tpm/tpm_demo
wolfSSL Entering wolfCrypt_Init
TPM2: Caps 0x30000697, Did 0x001b, Vid 0x15d1, Rid 0x10 
Command: 12
	80 01 00 00 00 0c 00 00 01 44 00 00             | .........D..
Response: 10
	80 01 00 00 00 0a 00 00 01 00                   | ..........
TPM2_Startup pass
Command: 11
	80 01 00 00 00 0b 00 00 01 43 01                | .........C.
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_SelfTest pass
Command: 10
	80 01 00 00 00 0a 00 00 01 7c                   | .........|
Response: 26
	80 01 00 00 00 1a 00 00 00 00 00 0a 00 01 f9 db | ................
	00 00 00 00 00 00 00 00 00 00                   | ..........
TPM2_GetTestResult: Size 10, Rc 0x0
	00 01 f9 db 00 00 00 00 00 00                   | ..........
Command: 16
	80 01 00 00 00 10 00 00 01 42 00 00 00 01 00 01 | .........B......
Response: 14
	80 01 00 00 00 0e 00 00 00 00 00 00 00 00       | ..............
TPM2_IncrementalSelfTest: Rc 0x0, Alg 0x1 (Todo 0)
Command: 22
	80 01 00 00 00 16 00 00 01 7a 00 00 00 06 00 00 | .........z......
	01 00 00 00 00 01                               | ......
Response: 27
	80 01 00 00 00 1b 00 00 00 00 01 00 00 00 06 00 | ................
	00 00 01 00 00 01 00 32 2e 30 00                | .......2.0.
TPM2_GetCapability: Property FamilyIndicator 0x322e3000
Command: 22
	80 01 00 00 00 16 00 00 01 7a 00 00 00 06 00 00 | .........z......
	01 12 00 00 00 01                               | ......
Response: 27
	80 01 00 00 00 1b 00 00 00 00 01 00 00 00 06 00 | ................
	00 00 01 00 00 01 12 00 00 00 18                | ...........
TPM2_GetCapability: Property PCR Count 24
Command: 12
	80 01 00 00 00 0c 00 00 01 7b 00 20             | .........{. 
Response: 44
	80 01 00 00 00 2c 00 00 00 00 00 20 a9 db 8e 38 | .....,..... ...8
	42 69 9a db e8 0a 09 59 3f 6f b5 9e 36 65 64 b4 | Bi.....Y?o..6ed.
	1f 7b ba a0 38 16 97 62 9b 67 4d b0             | .{..8..b.gM.
TPM2_GetRandom: Got 32 bytes
	a9 db 8e 38 42 69 9a db e8 0a 09 59 3f 6f b5 9e | ...8Bi.....Y?o..
	36 65 64 b4 1f 7b ba a0 38 16 97 62 9b 67 4d b0 | 6ed..{..8..b.gM.
Command: 44
	80 01 00 00 00 2c 00 00 01 46 00 20 a9 db 8e 38 | .....,...F. ...8
	42 69 9a db e8 0a 09 59 3f 6f b5 9e 36 65 64 b4 | Bi.....Y?o..6ed.
	1f 7b ba a0 38 16 97 62 9b 67 4d b0             | .{..8..b.gM.
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_StirRandom: success
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 01 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 01 00 00 00 00 00 01 00 20 bb 22 | ............. ."
	75 c4 9f 28 ad 52 ca e6 d5 5e 34 a9 74 a5 8c 7a | u..(.R...^4.t..z
	3b a2 6f 97 6e 8e cb be 7a 53 69 18 dc 73       | ;.o.n...zSi..s
TPM2_PCR_Read: Index 0, Digest Sz 32, Update Counter 21
	bb 22 75 c4 9f 28 ad 52 ca e6 d5 5e 34 a9 74 a5 | ."u..(.R...^4.t.
	8c 7a 3b a2 6f 97 6e 8e cb be 7a 53 69 18 dc 73 | .z;.o.n...zSi..s
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 02 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 02 00 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 1, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 04 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 04 00 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 2, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 08 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 08 00 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 3, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 10 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 10 00 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 4, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 20 00 00                                     | . ..
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 20 00 00 00 00 00 01 00 20 00 00 | ..... ....... ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 5, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 40 00 00                                     | .@..
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 40 00 00 00 00 00 01 00 20 00 00 | .....@....... ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 6, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 80 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 80 00 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 7, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 01 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 01 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 8, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 02 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 02 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 9, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 04 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 04 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 10, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 08 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 08 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 11, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 10 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 10 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 12, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 20 00                                     | .. .
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 20 00 00 00 00 01 00 20 00 00 | ...... ...... ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 13, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 40 00                                     | ..@.
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 40 00 00 00 00 01 00 20 00 00 | ......@...... ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 14, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 80 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 80 00 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 15, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 01                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 01 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 16, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 02                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 02 00 00 00 01 00 20 ff ff | ............. ..
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff       | ..............
TPM2_PCR_Read: Index 17, Digest Sz 32, Update Counter 21
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 04                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 04 00 00 00 01 00 20 ff ff | ............. ..
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff       | ..............
TPM2_PCR_Read: Index 18, Digest Sz 32, Update Counter 21
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 08                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 08 00 00 00 01 00 20 ff ff | ............. ..
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff       | ..............
TPM2_PCR_Read: Index 19, Digest Sz 32, Update Counter 21
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 10                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 10 00 00 00 01 00 20 ff ff | ............. ..
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff       | ..............
TPM2_PCR_Read: Index 20, Digest Sz 32, Update Counter 21
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 20                                     | ... 
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 20 00 00 00 01 00 20 ff ff | ....... ..... ..
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff       | ..............
TPM2_PCR_Read: Index 21, Digest Sz 32, Update Counter 21
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 40                                     | ...@
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 40 00 00 00 01 00 20 ff ff | .......@..... ..
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff       | ..............
TPM2_PCR_Read: Index 22, Digest Sz 32, Update Counter 21
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
	ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 00 00 80                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 15 00 00 | .....>..........
	00 01 00 0b 03 00 00 80 00 00 00 01 00 20 00 00 | ............. ..
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00       | ..............
TPM2_PCR_Read: Index 23, Digest Sz 32, Update Counter 21
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 65
	80 02 00 00 00 41 00 00 01 82 00 00 00 00 00 00 | .....A..........
	00 09 40 00 00 09 00 00 01 00 00 00 00 00 01 00 | ..@.............
	0b 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e | ................
	0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e | ................
	1f                                              | .
Response: 19
	80 02 00 00 00 13 00 00 00 00 00 00 00 00 00 00 | ................
	01 00 00                                        | ...
TPM2_PCR_Extend success
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 0b | .........~......
	03 01 00 00                                     | ....
Response: 62
	80 01 00 00 00 3e 00 00 00 00 00 00 00 16 00 00 | .....>..........
	00 01 00 0b 03 01 00 00 00 00 00 01 00 20 de 96 | ............. ..
	1d 6b 9f 26 9c 61 ba 48 52 12 34 80 da ac ed 4c | .k.&.a.HR.4....L
	6a 5d 6d f1 90 94 1f b2 0b e4 17 d7 8a 2e       | j]m...........
TPM2_PCR_Read: Index 0, Digest Sz 32, Update Counter 22
	de 96 1d 6b 9f 26 9c 61 ba 48 52 12 34 80 da ac | ...k.&.a.HR.4...
	ed 4c 6a 5d 6d f1 90 94 1f b2 0b e4 17 d7 8a 2e | .Lj]m...........
Command: 59
	80 01 00 00 00 3b 00 00 01 76 40 00 00 07 40 00 | .....;...v@...@.
	00 07 00 20 db 87 09 ee e0 9e 96 96 8b b6 a6 e7 | ... ............
	1f 4e 82 35 68 fd c2 b4 4d ba ff 38 4f 5a 23 c6 | .N.5h...M..8OZ#.
	40 df 30 05 00 00 01 00 10 00 0b                | @.0........
Response: 48
	80 01 00 00 00 30 00 00 00 00 03 00 00 00 00 20 | .....0......... 
	4e fb 16 59 7c 93 96 bd 2d 1a 75 cf f6 b9 58 ca | N..Y|...-.u...X.
	8e fe f6 44 d6 02 fe 68 c9 bd c5 53 ac 14 86 55 | ...D...h...S...U
TPM2_StartAuthSession: sessionHandle 0x3000000
Command: 14
	80 01 00 00 00 0e 00 00 01 89 03 00 00 00       | ..............
Response: 44
	80 01 00 00 00 2c 00 00 00 00 00 20 00 00 00 00 | .....,..... ....
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00             | ............
TPM2_PolicyGetDigest: size 32
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
Command: 20
	80 01 00 00 00 14 00 00 01 7e 00 00 00 01 00 04 | .........~......
	03 01 00 00                                     | ....
Response: 50
	80 01 00 00 00 32 00 00 00 00 00 00 00 16 00 00 | .....2..........
	00 01 00 04 03 01 00 00 00 00 00 01 00 14 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00                                           | ..
TPM2_PCR_Read: Index 0, Digest Sz 20, Update Counter 22
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00                                     | ....
wc_Hash of PCR[0]: size 32
	de 47 c9 b2 7e b8 d3 00 db b5 f2 c3 53 e6 32 c3 | .G..~.......S.2.
	93 26 2c f0 63 40 c4 fa 7f 1b 40 c4 cb d3 6f 90 | .&,.c@....@...o.
Command: 58
	80 01 00 00 00 3a 00 00 01 7f 03 00 00 00 00 20 | .....:......... 
	de 47 c9 b2 7e b8 d3 00 db b5 f2 c3 53 e6 32 c3 | .G..~.......S.2.
	93 26 2c f0 63 40 c4 fa 7f 1b 40 c4 cb d3 6f 90 | .&,.c@....@...o.
	00 00 00 01 00 04 03 01 00 00                   | ..........
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_PolicyPCR: Updated
Command: 14
	80 01 00 00 00 0e 00 00 01 80 03 00 00 00       | ..............
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_PolicyRestart: Done
Command: 36
	80 01 00 00 00 24 00 00 01 86 00 16 54 68 69 73 | .....$......This
	49 73 41 53 65 63 72 65 74 55 73 61 67 65 41 75 | IsASecretUsageAu
	74 68 00 0b                                     | th..
Response: 14
	80 01 00 00 00 0e 00 00 00 00 80 00 00 00       | ..............
TPM2_HashSequenceStart: sequenceHandle 0x80000000
Command: 107
	80 02 00 00 00 6b 00 00 01 5c 80 00 00 00 00 00 | .....k...\......
	00 1f 40 00 00 09 00 00 01 00 16 54 68 69 73 49 | ..@........ThisI
	73 41 53 65 63 72 65 74 55 73 61 67 65 41 75 74 | sASecretUsageAut
	68 00 38 61 62 63 64 62 63 64 65 63 64 65 66 64 | h.8abcdbcdecdefd
	65 66 67 65 66 67 68 66 67 68 69 67 68 69 6a 68 | efgefghfghighijh
	69 6a 6b 69 6a 6b 6c 6a 6b 6c 6d 6b 6c 6d 6e 6c | ijkijkljklmklmnl
	6d 6e 6f 6d 6e 6f 70 6e 6f 70 71                | mnomnopnopq
Response: 19
	80 02 00 00 00 13 00 00 00 00 00 00 00 00 00 00 | ................
	01 00 00                                        | ...
Command: 55
	80 02 00 00 00 37 00 00 01 3e 80 00 00 00 00 00 | .....7...>......
	00 1f 40 00 00 09 00 00 01 00 16 54 68 69 73 49 | ..@........ThisI
	73 41 53 65 63 72 65 74 55 73 61 67 65 41 75 74 | sASecretUsageAut
	68 00 00 40 00 00 07                            | h..@...
Response: 61
	80 02 00 00 00 3d 00 00 00 00 00 00 00 2a 00 20 | .....=.......*. 
	24 8d 6a 61 d2 06 38 b8 e5 c0 26 93 0c 3e 60 39 | $.ja..8...&..>`9
	a3 3c e4 59 64 ff 21 67 f6 ec ed d4 19 db 06 c1 | .<.Yd.!g........
	80 24 40 00 00 07 00 00 00 00 01 00 00          | .$@..........
Hash SHA256 test success
Command: 355
	80 02 00 00 01 63 00 00 01 31 40 00 00 0b 00 00 | .....c...1@.....
	00 09 40 00 00 09 00 00 01 00 00 00 04 00 00 00 | ..@.............
	00 01 3a 00 01 00 0b 00 03 00 b2 00 20 83 71 97 | ..:......... .q.
	67 44 84 b3 f8 1a 90 cc 8d 46 a5 d7 24 fd 52 d7 | gD.......F..$.R.
	6e 06 52 0b 64 f2 a1 da 1b 33 14 69 aa 00 06 00 | n.R.d....3.i....
	80 00 43 00 10 08 00 00 00 00 00 01 00 00 00 00 | ..C.............
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00                                        | ...
Response: 506
	80 02 00 00 01 fa 00 00 00 00 80 00 00 00 00 00 | ................
	01 e3 01 3a 00 01 00 0b 00 03 00 b2 00 20 83 71 | ...:......... .q
	97 67 44 84 b3 f8 1a 90 cc 8d 46 a5 d7 24 fd 52 | .gD.......F..$.R
	d7 6e 06 52 0b 64 f2 a1 da 1b 33 14 69 aa 00 06 | .n.R.d....3.i...
	00 80 00 43 00 10 08 00 00 00 00 00 01 00 b1 03 | ...C............
	a5 d0 6f 7d ed 90 50 a5 42 6c 8e aa 03 23 a8 8d | ..o}..P.Bl...#..
	53 7b 92 bb 8a 2f 82 68 43 5c f7 d3 1f bf 58 4a | S{.../.hC\....XJ
	d8 58 c4 ca c2 d6 e7 dd 06 41 e5 b2 fa 05 18 40 | .X.......A.....@
	ce 76 e3 e9 0b b5 3a 51 38 8c 62 2b 20 9a 69 e0 | .v....:Q8.b+ .i.
	2e a2 c7 08 2a 6a 37 79 a2 55 4d b8 6e 4b b1 67 | ....*j7y.UM.nK.g
	91 5b e2 52 18 10 23 d4 a9 2b 5f a2 f1 46 99 51 | .[.R..#..+_..F.Q
	40 19 6b a4 27 f4 24 60 eb cc 0f 05 e6 d4 be c2 | @.k.'.$`........
	92 07 50 2b 9c 53 5c 37 0c 98 9c 74 5a 6c 60 b3 | ..P+.S\7...tZl`.
	21 d9 6e d9 f3 14 83 64 68 6e 50 2d 3f c0 17 ee | !.n....dhnP-?...
	84 3c 59 5e 48 0a 99 18 bc cc 29 d5 1b 9c 68 5a | .<Y^H.....)...hZ
	f4 85 a3 e6 f1 d1 54 cd 54 2c 5d e4 b7 f7 aa 18 | ......T.T,].....
	fa 22 94 9b 8f 2b 77 86 cb b9 cf 0f 71 9a 35 ba | ."...+w.....q.5.
	da 21 f5 bd bd e6 7c 26 2f b5 47 ab 8c 6f 44 42 | .!....|&/.G..oDB
	42 87 3b ae 71 31 3d de 34 5f 2e e8 49 57 c7 f2 | B.;.q1=.4_..IW..
	ef 71 ca 09 3d cf 22 87 21 3f 6c c9 45 79 68 df | .q..=.".!?l.Eyh.
	85 a7 8c 8b 34 24 c2 b1 2b 7e 86 ee e8 dd 00 37 | ....4$..+~.....7
	00 00 00 00 00 20 e3 b0 c4 42 98 fc 1c 14 9a fb | ..... ...B......
	f4 c8 99 6f b9 24 27 ae 41 e4 64 9b 93 4c a4 95 | ...o.$'.A.d..L..
	99 1b 78 52 b8 55 01 00 10 00 04 40 00 00 0b 00 | ..xR.U.....@....
	04 40 00 00 0b 00 00 00 20 28 d0 26 fa fd 74 91 | .@...... (.&..t.
	06 74 3e 27 c4 28 05 51 58 5e 5d 17 66 8e b5 21 | .t>'.(.QX^].f..!
	83 5e d6 01 27 ef fc 05 d4 80 21 40 00 00 0b 00 | .^..'.....!@....
	20 b1 a1 dc 60 e2 43 da be b3 7d b7 ac 00 20 4e |  ...`.C...}... N
	c0 47 35 0c 37 f1 da 50 f2 2e e8 d3 98 c1 03 d7 | .G5.7..P........
	9b 00 22 00 0b 9d e5 de 24 3a a7 c8 73 c5 aa af | ..".....$:..s...
	8d 7c af eb c5 17 f3 a6 bd f7 36 ca bd af 29 20 | .|........6...) 
	91 5a 12 f6 7c 00 00 01 00 00                   | .Z..|.....
TPM2_CreatePrimary: Endorsement 0x80000000 (314 bytes)
Command: 338
	80 02 00 00 01 52 00 00 01 31 40 00 00 0b 00 00 | .....R...1@.....
	00 09 40 00 00 09 00 00 01 00 00 00 13 00 0f 57 | ..@............W
	6f 6c 66 54 50 4d 50 6c 61 74 50 73 77 64 00 00 | olfTPMPlatPswd..
	01 1a 00 01 00 0b 00 03 04 72 00 00 00 06 00 80 | .........r......
	00 43 00 10 08 00 00 00 00 00 01 00 00 00 00 00 | .C..............
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | ................
	00 00                                           | ..
Response: 474
	80 02 00 00 01 da 00 00 00 00 80 00 00 01 00 00 | ................
	01 c3 01 1a 00 01 00 0b 00 03 04 72 00 00 00 06 | ...........r....
	00 80 00 43 00 10 08 00 00 00 00 00 01 00 ac 83 | ...C............
	2a 7a 3f 2c 43 f3 57 95 ec 89 d2 db 6f 7d a8 2c | *z?,C.W.....o}.,
	0a 72 e7 36 0c a5 4b bf b4 a8 8e 99 d1 f1 e3 2a | .r.6..K........*
	2e 54 d9 93 e6 38 ae 0d c2 d5 7a 1b c1 41 29 20 | .T...8....z..A) 
	01 0d a8 e9 71 f0 ab 8a d3 8e 7e 41 93 ea b1 bd | ....q.....~A....
	69 10 37 cb 8f ca 17 c7 77 ad 28 df a4 22 b3 98 | i.7.....w.(.."..
	3b 32 83 46 a1 f1 5a d7 5c 10 1d 74 cb e4 4a 14 | ;2.F..Z.\..t..J.
	c8 2d 25 e6 36 ca d2 cc 07 63 16 76 7c 0d 73 93 | .-%.6....c.v|.s.
	37 75 ea 96 5a dc bf 6c 20 ba 9f 08 b0 51 ba ef | 7u..Z..l ....Q..
	84 63 e8 0a 1a 88 0a 85 02 ac 17 f3 ae dd 24 c0 | .c............$.
	04 3e 97 88 e1 91 c9 e4 6d 5a 8a c5 a8 df 67 f1 | .>......mZ....g.
	5b 65 61 02 72 4c 0b cc 3c 00 af 22 01 8a 21 ce | [ea.rL..<.."..!.
	23 7e 91 4c 32 99 cd 18 4b af d6 74 c6 ff 67 c6 | #~.L2...K..t..g.
	f5 0f 90 a6 6b b9 6c 87 dd c4 a9 79 86 bc 89 ad | ....k.l....y....
	7c a2 88 fc db 42 69 b6 6f 52 26 0e 0a c7 5e 09 | |....Bi.oR&...^.
	65 87 80 87 77 34 11 17 93 15 7b ad e4 1b 9a c9 | e...w4....{.....
	ff 21 77 37 61 5e ee 09 6d 44 d2 d7 e1 e1 00 37 | .!w7a^..mD.....7
	00 00 00 00 00 20 e3 b0 c4 42 98 fc 1c 14 9a fb | ..... ...B......
	f4 c8 99 6f b9 24 27 ae 41 e4 64 9b 93 4c a4 95 | ...o.$'.A.d..L..
	99 1b 78 52 b8 55 01 00 10 00 04 40 00 00 0b 00 | ..xR.U.....@....
	04 40 00 00 0b 00 00 00 20 28 d0 26 fa fd 74 91 | .@...... (.&..t.
	06 74 3e 27 c4 28 05 51 58 5e 5d 17 66 8e b5 21 | .t>'.(.QX^].f..!
	83 5e d6 01 27 ef fc 05 d4 80 21 40 00 00 0b 00 | .^..'.....!@....
	20 b7 80 b6 86 9b 9d 00 fe 2d 08 0e 75 2d 34 a8 |  ........-..u-4.
	67 e8 74 86 70 bc 5c 86 71 be 11 a4 0b e5 e0 cb | g.t.p.\.q.......
	00 00 22 00 0b c2 e3 0b b7 c0 e3 7c b2 5c c4 16 | .."........|.\..
	0c f5 8c 1e c8 b8 dd 3d 4b e1 d5 d5 58 45 33 23 | .......=K...XE3#
	2b 74 22 18 04 00 00 01 00 00                   | +t".......
TPM2_CreatePrimary: Platform 0x80000001 (282 bytes)
Command: 332
	80 01 00 00 01 4c 00 00 01 67 00 00 01 3a 00 01 | .....L...g...:..
	00 0b 00 03 00 b2 00 20 83 71 97 67 44 84 b3 f8 | ....... .q.gD...
	1a 90 cc 8d 46 a5 d7 24 fd 52 d7 6e 06 52 0b 64 | ....F..$.R.n.R.d
	f2 a1 da 1b 33 14 69 aa 00 06 00 80 00 43 00 10 | ....3.i......C..
	08 00 00 00 00 00 01 00 b1 03 a5 d0 6f 7d ed 90 | ............o}..
	50 a5 42 6c 8e aa 03 23 a8 8d 53 7b 92 bb 8a 2f | P.Bl...#..S{.../
	82 68 43 5c f7 d3 1f bf 58 4a d8 58 c4 ca c2 d6 | .hC\....XJ.X....
	e7 dd 06 41 e5 b2 fa 05 18 40 ce 76 e3 e9 0b b5 | ...A.....@.v....
	3a 51 38 8c 62 2b 20 9a 69 e0 2e a2 c7 08 2a 6a | :Q8.b+ .i.....*j
	37 79 a2 55 4d b8 6e 4b b1 67 91 5b e2 52 18 10 | 7y.UM.nK.g.[.R..
	23 d4 a9 2b 5f a2 f1 46 99 51 40 19 6b a4 27 f4 | #..+_..F.Q@.k.'.
	24 60 eb cc 0f 05 e6 d4 be c2 92 07 50 2b 9c 53 | $`..........P+.S
	5c 37 0c 98 9c 74 5a 6c 60 b3 21 d9 6e d9 f3 14 | \7...tZl`.!.n...
	83 64 68 6e 50 2d 3f c0 17 ee 84 3c 59 5e 48 0a | .dhnP-?....<Y^H.
	99 18 bc cc 29 d5 1b 9c 68 5a f4 85 a3 e6 f1 d1 | ....)...hZ......
	54 cd 54 2c 5d e4 b7 f7 aa 18 fa 22 94 9b 8f 2b | T.T,]......"...+
	77 86 cb b9 cf 0f 71 9a 35 ba da 21 f5 bd bd e6 | w.....q.5..!....
	7c 26 2f b5 47 ab 8c 6f 44 42 42 87 3b ae 71 31 | |&/.G..oDBB.;.q1
	3d de 34 5f 2e e8 49 57 c7 f2 ef 71 ca 09 3d cf | =.4_..IW...q..=.
	22 87 21 3f 6c c9 45 79 68 df 85 a7 8c 8b 34 24 | ".!?l.Eyh.....4$
	c2 b1 2b 7e 86 ee e8 dd 40 00 00 07             | ..+~....@...
Response: 50
	80 01 00 00 00 32 00 00 00 00 80 00 00 02 00 22 | .....2........."
	00 0b 9d e5 de 24 3a a7 c8 73 c5 aa af 8d 7c af | .....$:..s....|.
	eb c5 17 f3 a6 bd f7 36 ca bd af 29 20 91 5a 12 | .......6...) .Z.
	f6 7c                                           | .|
TPM2_LoadExternal: 0x80000002
Command: 84
	80 01 00 00 00 54 00 00 01 68 80 00 00 02 00 20 | .....T...h..... 
	11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 | ................
	11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 | ................
	00 22 00 0b 9d e5 de 24 3a a7 c8 73 c5 aa af 8d | .".....$:..s....
	7c af eb c5 17 f3 a6 bd f7 36 ca bd af 29 20 91 | |........6...) .
	5a 12 f6 7c                                     | Z..|
Response: 338
	80 01 00 00 01 52 00 00 00 00 00 44 00 20 28 87 | .....R.....D. (.
	ce da df 3a 12 6c 3a ef 23 d5 fc 13 0e 11 74 35 | ...:.l:.#.....t5
	f9 f4 58 db f2 ea a5 13 bf 37 78 da 71 6f 7f c8 | ..X......7x.qo..
	cc 38 a2 59 fe 97 3f 47 36 51 0d 43 82 d2 fc 12 | .8.Y..?G6Q.C....
	40 b0 32 33 08 20 7f bf 59 13 2e e5 7b f2 1d 80 | @.23. ..Y...{...
	01 00 a1 a1 b8 bb d3 5d b6 7e 30 a2 0c 62 3b d6 | .......].~0..b;.
	02 f6 9b 7f 94 41 66 cd f0 2b 2a e1 c9 6e 3e dc | .....Af..+*..n>.
	45 2b e9 7b c1 bb 96 04 36 17 84 66 91 bc 4a 80 | E+.{....6..f..J.
	62 7a 87 32 df 41 fc ec bb 57 03 f2 8b 3b e7 3f | bz.2.A...W...;.?
	12 ac 8a 38 cb 58 a0 e9 4b e1 0c 72 a3 81 ac fc | ...8.X..K..r....
	ad 22 b8 0c 40 cc 3f f3 6d 6e f7 f8 ce dc ff ee | ."..@.?.mn......
	54 82 bb 2b 7d ee 06 32 97 96 9f 88 04 18 34 51 | T..+}..2......4Q
	bf 3a 08 2b 42 3e ca 95 47 cb f5 d2 3e cd 81 78 | .:.+B>..G...>..x
	f3 26 88 6f 29 7c cf cc 87 41 f4 1a 09 a4 20 71 | .&.o)|...A.... q
	b1 c5 73 4c 5d 9c 56 a6 5e 49 6c ac 11 50 d0 e3 | ..sL].V.^Il..P..
	16 2f b0 69 68 34 7d e7 6c 7d e2 99 36 ad 6e 34 | ./.ih4}.l}..6.n4
	c9 36 b9 9b fa 6f b5 d2 d7 55 7f 49 41 da f9 5c | .6...o...U.IA..\
	55 bc 6c e9 02 d3 0d 33 e1 84 bf f0 9f df dc 6d | U.l....3.......m
	56 18 41 29 86 63 b3 13 f5 21 00 7f 2f 0e 8a 19 | V.A).c...!../...
	91 f6 22 83 46 b6 3a 09 81 43 af 7c 91 65 c8 db | ..".F.:..C.|.e..
	15 c1 99 f7 88 7e dc 69 b0 fe 52 83 01 ef c7 76 | .....~.i..R....v
	ca 09                                           | ..
TPM2_MakeCredential: credentialBlob 68, secret 256
Command: 14
	80 01 00 00 00 0e 00 00 01 73 80 00 00 02       | .........s....
Response: 398
	80 01 00 00 01 8e 00 00 00 00 01 3a 00 01 00 0b | ...........:....
	00 03 00 b2 00 20 83 71 97 67 44 84 b3 f8 1a 90 | ..... .q.gD.....
	cc 8d 46 a5 d7 24 fd 52 d7 6e 06 52 0b 64 f2 a1 | ..F..$.R.n.R.d..
	da 1b 33 14 69 aa 00 06 00 80 00 43 00 10 08 00 | ..3.i......C....
	00 00 00 00 01 00 b1 03 a5 d0 6f 7d ed 90 50 a5 | ..........o}..P.
	42 6c 8e aa 03 23 a8 8d 53 7b 92 bb 8a 2f 82 68 | Bl...#..S{.../.h
	43 5c f7 d3 1f bf 58 4a d8 58 c4 ca c2 d6 e7 dd | C\....XJ.X......
	06 41 e5 b2 fa 05 18 40 ce 76 e3 e9 0b b5 3a 51 | .A.....@.v....:Q
	38 8c 62 2b 20 9a 69 e0 2e a2 c7 08 2a 6a 37 79 | 8.b+ .i.....*j7y
	a2 55 4d b8 6e 4b b1 67 91 5b e2 52 18 10 23 d4 | .UM.nK.g.[.R..#.
	a9 2b 5f a2 f1 46 99 51 40 19 6b a4 27 f4 24 60 | .+_..F.Q@.k.'.$`
	eb cc 0f 05 e6 d4 be c2 92 07 50 2b 9c 53 5c 37 | ..........P+.S\7
	0c 98 9c 74 5a 6c 60 b3 21 d9 6e d9 f3 14 83 64 | ...tZl`.!.n....d
	68 6e 50 2d 3f c0 17 ee 84 3c 59 5e 48 0a 99 18 | hnP-?....<Y^H...
	bc cc 29 d5 1b 9c 68 5a f4 85 a3 e6 f1 d1 54 cd | ..)...hZ......T.
	54 2c 5d e4 b7 f7 aa 18 fa 22 94 9b 8f 2b 77 86 | T,]......"...+w.
	cb b9 cf 0f 71 9a 35 ba da 21 f5 bd bd e6 7c 26 | ....q.5..!....|&
	2f b5 47 ab 8c 6f 44 42 42 87 3b ae 71 31 3d de | /.G..oDBB.;.q1=.
	34 5f 2e e8 49 57 c7 f2 ef 71 ca 09 3d cf 22 87 | 4_..IW...q..=.".
	21 3f 6c c9 45 79 68 df 85 a7 8c 8b 34 24 c2 b1 | !?l.Eyh.....4$..
	2b 7e 86 ee e8 dd 00 22 00 0b 9d e5 de 24 3a a7 | +~.....".....$:.
	c8 73 c5 aa af 8d 7c af eb c5 17 f3 a6 bd f7 36 | .s....|........6
	ca bd af 29 20 91 5a 12 f6 7c 00 22 00 0b d7 73 | ...) .Z..|."...s
	88 35 94 97 8e 2e 91 52 b8 6f fc 15 72 f5 84 6a | .5.....R.o..r..j
	11 66 84 97 6a 0f 0a 28 e4 ea ea e9 16 03       | .f..j..(......
TPM2_ReadPublic Handle 0x80000002: pub 314, name 34, qualifiedName 34
Command: 14
	80 01 00 00 00 0e 00 00 01 65 80 00 00 02       | .........e....
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_FlushContext: Closed handle 0x80000002
Command: 109
	80 02 00 00 00 6d 00 00 01 53 80 00 00 01 00 00 | .....m...S......
	00 18 40 00 00 09 00 00 01 00 0f 57 6f 6c 66 54 | ..@........WolfT
	50 4d 50 6c 61 74 50 73 77 64 00 29 00 16 54 68 | PMPlatPswd.)..Th
	69 73 49 73 41 53 65 63 72 65 74 55 73 61 67 65 | isIsASecretUsage
	41 75 74 68 00 0f 54 68 69 73 49 73 4d 79 48 6d | Auth..ThisIsMyHm
	61 63 4b 65 79 00 10 00 08 00 0b 00 04 04 40 00 | acKey.........@.
	00 00 05 00 0b 00 00 00 00 00 00 00 00          | .............
Response: 403
	80 02 00 00 01 93 00 00 00 00 00 00 01 80 00 8d | ................
	00 20 c9 bf e1 83 af 4b a3 e8 e9 1e 2f bb c0 07 | . .....K..../...
	10 48 4a 96 76 c0 45 a9 ab ea f0 f4 d0 ce 69 9f | .HJ.v.E.......i.
	48 5d 00 10 a7 e0 e7 9e a1 ed 3f 73 8f 7f 31 ed | H]........?s..1.
	fd 48 36 18 e6 5a 3b 68 87 d4 9f d4 8d c4 30 9e | .H6..Z;h......0.
	c6 2c 76 cf 20 f6 b5 66 d0 39 7b 64 94 e7 5f 19 | .,v. ..f.9{d.._.
	27 f1 80 be 41 f1 ef f8 be 79 80 1c c0 e9 53 7e | '...A....y....S~
	78 36 fc e6 74 3b 33 60 c8 53 04 56 2b 9b ac 28 | x6..t;3`.S.V+..(
	70 f1 f9 de 21 d5 e1 4f 12 43 ac a6 fb ae c9 ed | p...!..O.C......
	5d 80 de f4 fb 36 fb a0 2b 51 67 5b ab 00 30 00 | ]....6..+Qg[..0.
	08 00 0b 00 04 04 40 00 00 00 05 00 0b 00 20 29 | ......@....... )
	bb 43 68 a9 4d a8 af 59 b2 af 39 e6 96 5a e2 2c | .Ch.M..Y..9..Z.,
	3b 62 1e 90 8b d7 7a a4 e5 7f 62 9b c1 0d d8 00 | ;b....z...b.....
	73 00 00 00 00 00 20 e3 b0 c4 42 98 fc 1c 14 9a | s..... ...B.....
	fb f4 c8 99 6f b9 24 27 ae 41 e4 64 9b 93 4c a4 | ....o.$'.A.d..L.
	95 99 1b 78 52 b8 55 01 00 0b 00 22 00 0b c2 e3 | ...xR.U...."....
	0b b7 c0 e3 7c b2 5c c4 16 0c f5 8c 1e c8 b8 dd | ....|.\.........
	3d 4b e1 d5 d5 58 45 33 23 2b 74 22 18 04 00 22 | =K...XE3#+t"..."
	00 0b 1d 80 aa de 66 1b ea 15 49 a1 da 87 32 b9 | ......f...I...2.
	03 98 ae e6 24 ad 63 7d f3 e1 a8 5f 84 ba 12 0a | ....$.c}..._....
	79 6a 00 00 00 20 2e 01 54 ce 79 36 a0 30 53 a7 | yj... ..T.y6.0S.
	3a 0a e8 9f 9c 26 dd ec 52 00 0a 0b 8c 06 26 36 | :....&..R.....&6
	54 0e f0 f7 39 e9 80 21 40 00 00 0b 00 20 3e cc | T...9..!@.... >.
	ee c9 48 6f a0 be d7 ba 3c 79 63 88 34 e6 be 8c | ..Ho....<yc.4...
	9c 7c 73 21 4e 11 da 87 c3 24 5d 92 1e 2f 00 00 | .|s!N....$]../..
	01 00 00                                        | ...
Create HMAC-SHA256 Key success, public 48, Private 141
Command: 235
	80 02 00 00 00 eb 00 00 01 57 80 00 00 01 00 00 | .........W......
	00 18 40 00 00 09 00 00 01 00 0f 57 6f 6c 66 54 | ..@........WolfT
	50 4d 50 6c 61 74 50 73 77 64 00 8d 00 20 c9 bf | PMPlatPswd... ..
	e1 83 af 4b a3 e8 e9 1e 2f bb c0 07 10 48 4a 96 | ...K..../....HJ.
	76 c0 45 a9 ab ea f0 f4 d0 ce 69 9f 48 5d 00 10 | v.E.......i.H]..
	a7 e0 e7 9e a1 ed 3f 73 8f 7f 31 ed fd 48 36 18 | ......?s..1..H6.
	e6 5a 3b 68 87 d4 9f d4 8d c4 30 9e c6 2c 76 cf | .Z;h......0..,v.
	20 f6 b5 66 d0 39 7b 64 94 e7 5f 19 27 f1 80 be |  ..f.9{d.._.'...
	41 f1 ef f8 be 79 80 1c c0 e9 53 7e 78 36 fc e6 | A....y....S~x6..
	74 3b 33 60 c8 53 04 56 2b 9b ac 28 70 f1 f9 de | t;3`.S.V+..(p...
	21 d5 e1 4f 12 43 ac a6 fb ae c9 ed 5d 80 de f4 | !..O.C......]...
	fb 36 fb a0 2b 51 67 5b ab 00 30 00 08 00 0b 00 | .6..+Qg[..0.....
	04 04 40 00 00 00 05 00 0b 00 20 29 bb 43 68 a9 | ..@....... ).Ch.
	4d a8 af 59 b2 af 39 e6 96 5a e2 2c 3b 62 1e 90 | M..Y..9..Z.,;b..
	8b d7 7a a4 e5 7f 62 9b c1 0d d8                | ..z...b....
Response: 59
	80 02 00 00 00 3b 00 00 00 00 80 00 00 02 00 00 | .....;..........
	00 24 00 22 00 0b ce 4a b2 ef 1c 0c 13 e9 11 fb | .$."...J........
	1a 96 40 50 5c ce a4 16 ea 81 1f 48 98 a9 4c 99 | ..@P\......H..L.
	8f ba 3e 1e 9f 96 00 00 01 00 00                | ..>........
TPM2_Load New HMAC Key Handle 0x80000002
Command: 18
	80 01 00 00 00 12 00 00 01 6c 03 00 00 00 00 00 | .........l......
	01 50                                           | .P
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
Command: 80
	80 02 00 00 00 50 00 00 01 50 80 00 00 02 80 00 | .....P...P......
	00 01 00 00 00 18 40 00 00 09 00 00 01 00 0f 57 | ......@........W
	6f 6c 66 54 50 4d 50 6c 61 74 50 73 77 64 00 20 | olfTPMPlatPswd. 
	d9 17 d0 db 65 90 22 e3 53 82 f3 8f 85 65 5b 3f | ....e.".S....e[?
	33 fd ae 06 5a d0 a7 b1 0a 12 01 31 99 36 ab 8b | 3...Z......1.6..
Response: 10
	80 01 00 00 00 0a 00 00 09 a2                   | ..........
TPM2_ObjectChangeAuth failed 2466: Unknown
TPM2_ObjectChangeAuth: private 0
Command: 14
	80 01 00 00 00 0e 00 00 01 65 80 00 00 02       | .........e....
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_FlushContext: Closed handle 0x80000002
Command: 102
	80 02 00 00 00 66 00 00 01 53 80 00 00 01 00 00 | .....f...S......
	00 18 40 00 00 09 00 00 01 00 0f 57 6f 6c 66 54 | ..@........WolfT
	50 4d 50 6c 61 74 50 73 77 64 00 1a 00 16 54 68 | PMPlatPswd....Th
	69 73 49 73 41 53 65 63 72 65 74 55 73 61 67 65 | isIsASecretUsage
	41 75 74 68 00 00 00 18 00 23 00 0b 00 04 04 60 | Auth.....#.....`
	00 00 00 10 00 18 00 0b 00 03 00 10 00 00 00 00 | ................
	00 00 00 00 00 00                               | ......
Response: 428
	80 02 00 00 01 ac 00 00 00 00 00 00 01 99 00 7e | ...............~
	00 20 50 04 c5 bd ed 85 46 ba f6 94 68 79 15 94 | . P.....F...hy..
	7d 20 1f ae 17 4d af 30 be 91 13 71 46 bc 2e 1a | } ...M.0...qF...
	5b 45 00 10 bd 85 77 eb ee 44 e1 cf f6 8e 1f 20 | [E....w..D..... 
	3b 37 53 3d f3 12 b0 bd 90 fa 04 da 58 7d cf 24 | ;7S=........X}.$
	11 cd 50 08 ef b2 2d a2 ba a1 85 68 84 d4 e9 3a | ..P...-....h...:
	e8 35 6f 02 0a f3 4c 0c b2 d4 7d 9f cf 70 43 b9 | .5o...L...}..pC.
	52 aa eb 1d 95 65 91 c8 7c 83 ef 5f 41 01 e7 04 | R....e..|.._A...
	0e 98 bc f2 83 60 f1 c9 92 05 79 ac 1c 63 00 58 | .....`....y..c.X
	00 23 00 0b 00 04 04 60 00 00 00 10 00 18 00 0b | .#.....`........
	00 03 00 10 00 20 06 14 2f 5b fa 7c ee 98 9b 50 | ..... ../[.|...P
	83 c2 b5 38 09 1f fd 59 8c a3 2b 5b b4 30 46 58 | ...8...Y..+[.0FX
	12 c5 c0 ac 0b 0b 00 20 c9 36 c5 ae 33 02 ce 74 | ....... .6..3..t
	87 44 9f f7 48 c4 f6 3f 00 05 ec d8 7c 87 e2 c0 | .D..H..?....|...
	97 f7 5d f3 c0 54 de 9b 00 73 00 00 00 00 00 20 | ..]..T...s..... 
	e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 | ...B.........o.$
	27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55 | '.A.d..L....xR.U
	01 00 0b 00 22 00 0b c2 e3 0b b7 c0 e3 7c b2 5c | ...."........|.\
	c4 16 0c f5 8c 1e c8 b8 dd 3d 4b e1 d5 d5 58 45 | .........=K...XE
	33 23 2b 74 22 18 04 00 22 00 0b 1d 80 aa de 66 | 3#+t"..."......f
	1b ea 15 49 a1 da 87 32 b9 03 98 ae e6 24 ad 63 | ...I...2.....$.c
	7d f3 e1 a8 5f 84 ba 12 0a 79 6a 00 00 00 20 2e | }..._....yj... .
	01 54 ce 79 36 a0 30 53 a7 3a 0a e8 9f 9c 26 dd | .T.y6.0S.:....&.
	ec 52 00 0a 0b 8c 06 26 36 54 0e f0 f7 39 e9 80 | .R.....&6T...9..
	21 40 00 00 0b 00 20 b3 a4 8a e1 3c fe 13 1e d6 | !@.... ....<....
	83 1f b1 2e ea d3 c2 7b 1c a9 c9 dd af af 0d 1d | .......{........
	22 08 97 5a 9b cd d6 00 00 01 00 00             | "..Z........
TPM2_Create: New ECC Key: pub 88, priv 126
Command: 260
	80 02 00 00 01 04 00 00 01 57 80 00 00 01 00 00 | .........W......
	00 18 40 00 00 09 00 00 01 00 0f 57 6f 6c 66 54 | ..@........WolfT
	50 4d 50 6c 61 74 50 73 77 64 00 7e 00 20 50 04 | PMPlatPswd.~. P.
	c5 bd ed 85 46 ba f6 94 68 79 15 94 7d 20 1f ae | ....F...hy..} ..
	17 4d af 30 be 91 13 71 46 bc 2e 1a 5b 45 00 10 | .M.0...qF...[E..
	bd 85 77 eb ee 44 e1 cf f6 8e 1f 20 3b 37 53 3d | ..w..D..... ;7S=
	f3 12 b0 bd 90 fa 04 da 58 7d cf 24 11 cd 50 08 | ........X}.$..P.
	ef b2 2d a2 ba a1 85 68 84 d4 e9 3a e8 35 6f 02 | ..-....h...:.5o.
	0a f3 4c 0c b2 d4 7d 9f cf 70 43 b9 52 aa eb 1d | ..L...}..pC.R...
	95 65 91 c8 7c 83 ef 5f 41 01 e7 04 0e 98 bc f2 | .e..|.._A.......
	83 60 f1 c9 92 05 79 ac 1c 63 00 58 00 23 00 0b | .`....y..c.X.#..
	00 04 04 60 00 00 00 10 00 18 00 0b 00 03 00 10 | ...`............
	00 20 06 14 2f 5b fa 7c ee 98 9b 50 83 c2 b5 38 | . ../[.|...P...8
	09 1f fd 59 8c a3 2b 5b b4 30 46 58 12 c5 c0 ac | ...Y..+[.0FX....
	0b 0b 00 20 c9 36 c5 ae 33 02 ce 74 87 44 9f f7 | ... .6..3..t.D..
	48 c4 f6 3f 00 05 ec d8 7c 87 e2 c0 97 f7 5d f3 | H..?....|.....].
	c0 54 de 9b                                     | .T..
Response: 59
	80 02 00 00 00 3b 00 00 00 00 80 00 00 02 00 00 | .....;..........
	00 24 00 22 00 0b c2 9c 8a 96 5d 48 6c b3 1b 7b | .$."......]Hl..{
	41 5b 3e 07 06 4a 80 43 b9 53 5a 40 f0 8d 9f 3d | A[>..J.C.SZ@...=
	0f 6b 3e b4 5b 93 00 00 01 00 00                | .k>.[......
TPM2_Load New ECC Key Handle 0x80000002
Command: 14
	80 01 00 00 00 0e 00 00 01 65 80 00 00 02       | .........e....
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_FlushContext: Closed handle 0x80000002
Command: 14
	80 01 00 00 00 0e 00 00 01 65 03 00 00 00       | .........e....
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_FlushContext: Closed sessionHandle 0x3000000
Command: 14
	80 01 00 00 00 0e 00 00 01 65 80 00 00 00       | .........e....
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_FlushContext: Closed handle 0x80000000
Command: 14
	80 01 00 00 00 0e 00 00 01 65 80 00 00 01       | .........e....
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
TPM2_FlushContext: Closed handle 0x80000001
Command: 12
	80 01 00 00 00 0c 00 00 01 45 00 00             | .........E..
Response: 10
	80 01 00 00 00 0a 00 00 00 00                   | ..........
wolfSSL Entering wolfCrypt_Cleanup

```
